name: Patch Bootstrap TCLabs
on:
  workflow_dispatch:

jobs:
  patch:
    runs-on: ubuntu-latest
    steps:
      - name: Baixar Bootstrap Oficial
        run: |
          # Baixa o bootstrap oficial mais estável para aarch64
          curl -L github.com -o bootstrap.zip
          unzip bootstrap.zip -d temp_bootstrap

      - name: Aplicar Patch de Pacote (com.tclabs.codestudio)
        run: |
          echo "[-] Trocando com.termux por com.tclabs.codestudio em todos os binários..."
          # Este comando percorre todos os arquivos e substitui a string binária
          # O segredo é que o novo nome tem o mesmo número de caracteres ou é menor
          find temp_bootstrap -type f -exec sed -i 's/com.termux/com.tclabs.codestudio/g' {} +
          
      - name: Criar Novo ZIP
        run: |
          cd temp_bootstrap
          zip -r ../bootstrap-tclabs-codestudio.zip .
          cd ..

      - name: Upload do Resultado
        uses: actions/upload-artifact@v4
        with:
          name: bootstrap-final
          path: bootstrap-tclabs-codestudio.zip

